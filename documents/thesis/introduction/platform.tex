\section{The LinkQuad Platform}
    The LinkQuad is a modular quadrotor developed at LinkÃ¶ping University.
    The core configuration is equipped with a standard set of sensors
    (accelerometers, gyroscopes, pressure sensors, GPS and magnetometers),
    but for our purposes, a monocular camera has also been mounted.
    The camera feeds data into a microcomputer specifically devoted to video processing.
    This devoted microcomputer is what allows the primary on-board microcomputer
    to focus on state estimation and control, without being overloaded by
    video processing.

    The primary microcomputer is running a framework named C++ Robot Automation Platform (CRAP),
    which was developed by the thesis' author for this purpose. CRAP is a light-weight
    automation platform with a purpose similar to that of ROS\footnote{\url{http://www.ros.org/}}, a
    modular robotics framework developed by Willow Garage\footnote{\url{http://www.willowgarage.com/}}.
    It is, in contrast to ROS, primarily designed to run on the relatively low-end Linux systems
    that fits the payload and power demands of a MAV. The framework is further
    described in Appendix~\ref{app:crap}.

    The platform is also equipped with two microcontrollers, responsible
    for sensor sampling, motor control, flight logging etc., as depicted in
    Figure~\ref{fig:platform:schematic}. The microcontrollers also contain
    an implementation of a complementary filter to provide angle and
    height estimates from the available sensors.

    Using the \crap framework, the functionality of the thesis implementation is
    distributed in separated modules:
    \begin{description}
        \item[$\bullet$ Observer:] Sensor fusing state estimation. Chapter~\ref{cha:observer}.
        \item[$\bullet$ Control:]  Affine Quadratic Control. Chapter~\ref{cha:controller}.
        \item[$\bullet$ Logic:]    State-machine for scheduling controller parameters and reference trajectory. Chapter~\ref{cha:logic}.
    \end{description}


    \begin{figure}[h]
        \noindent\makebox[\textwidth]{%
            \begin{tikzpicture}[auto,>=latex']
            \tikzstyle{mcu} = [rectangle, draw=none, rounded corners=1mm, fill=Emerald,
                text centered, anchor=north, text=white,font=\small]
            \tikzstyle{sensor} = [rectangle, draw=none, fill=black,
                text centered, anchor=north, text=white,font=\tiny, node distance=0.8cm]
            \tikzstyle{camera} = [rectangle, draw=none, rounded corners=1mm, fill=red,
                text centered, anchor=north, text=white,font=\small]
            \tikzstyle{framework} = [rectangle, draw, fill=YellowGreen,
                text centered, anchor=north, text=white,font=\small,thin, minimum width=2cm,node distance=0.7cm]
            \tikzstyle{gumstix} = [rectangle, draw=none, fill=LimeGreen, rounded corners=2mm,
                text centered, anchor=north, text=white,font=\small]
            \tikzstyle{gumstixtext} = [rectangle, draw=none,
                text centered, align=center, anchor=north, text=white,font=\small]

            \node [gumstixtext] (primarytext) {Primary computer \\ \tiny{State-estimation and control}};
            \node [framework, below of=primarytext] (crap) {CRAP};
            \node [gumstixtext, right of=primarytext, node distance=5cm] (secondarytext) {Secondary computer \\ \tiny{Video processing}};
            \node [framework, below of=secondarytext] (ptam) {PTAM};

            \begin{pgfonlayer}{background}
                \node [gumstix, fit=(primarytext) (crap)] (primary) {};
            \end{pgfonlayer}
            \begin{pgfonlayer}{background}
                \node [gumstix, fit=(secondarytext) (ptam)] (secondary) {};
            \end{pgfonlayer}

            \node [mcu, below of=primary, xshift=-1.5cm, node distance=1.5cm] (smcu) {Sensor MCU};
            \node [mcu, right of=smcu, node distance=3cm] (cmcu) {Control MCU};
            \node [sensor, below of=smcu, xshift=-1.2cm] (accelerometer) {Acc.};
            \node [sensor, right of=accelerometer] (gyro) {Gyro};
            \node [sensor, right of=gyro] (magnetometer) {Mag.};
            \node [sensor, right of=magnetometer] (pressure) {hPa};
            \node [camera, right of=secondary, node distance=3cm] (camera) {Camera};
            \node [sensor, below of=cmcu] (esc) {Speed controller};
            \node [sensor, right of=esc, node distance=1.8cm] (sdcard) {SD-card};

            \path[-]
                        (primary) edge (secondary)
                        (primary.south) edge (smcu.north)
                        (primary.south) edge (cmcu.north)
                        (cmcu.south) edge (esc.north)
                        (smcu.south) edge (accelerometer.north)
                        (smcu.south) edge (gyro.north)
                        (smcu.south) edge (magnetometer.north)
                        (smcu.south) edge (pressure.north)
                        (secondary.east) edge (camera.west)
                        (smcu.east) edge (cmcu.west)
                        (cmcu.south) edge (sdcard.north)
                        ;
            \end{tikzpicture}
        }
        \caption{LinkQuad schematic.}
        \label{fig:platform:schematic}
    \end{figure}

    \begin{subfigures}{The LinkQuad development platform.}{fig:linkquad}
        \sfig{0.45}{LinkQuad}
        \sfig{0.45}{linkquadoutside}
    \end{subfigures}
